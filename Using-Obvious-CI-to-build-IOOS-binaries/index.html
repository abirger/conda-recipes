<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile"> 
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <title>
    
      Using Obvious CI to Build IOOS Binaries &middot; IOOS Conda Recipes
    
  </title>

  
  <link rel="stylesheet" href="http://abirger.github.io/conda-recipes/css/poole.css">
  <link rel="stylesheet" href="http://abirger.github.io/conda-recipes/css/syntax.css">
  <link rel="stylesheet" href="http://abirger.github.io/conda-recipes/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://abirger.github.io/conda-recipes/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="http://abirger.github.io/conda-recipes/assets/favicon.ico">

  
  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://abirger.github.io/conda-recipes/atom.xml">
</head>


  <body>

    
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p align="center">&middot; <a href="http://ioos.github.io/" target="_blank">IOOS GitHub Pages</a> &middot; <br>
	a collection of IOOS documentation and software</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="http://abirger.github.io/conda-recipes/">Home</a>


  <div class="sidebar-item">
    <p>Documents</p>
  </div>

<p style="text-align:right"> 
    
    
      
        <a class="sidebar-nav-item-list " href="http://abirger.github.io/conda-recipes/index.html">About IOOS Conda Packages &amp; Python Environment</a>
      
    
      
        <a class="sidebar-nav-item-list " href="http://abirger.github.io/conda-recipes/Setting-up-the-IOOS-Python-environment/">Installing the IOOS Anaconda Environment</a>
      
    
      
        <a class="sidebar-nav-item-list " href="http://abirger.github.io/conda-recipes/Updating-an-IOOS-anaconda-package/">Updating an IOOS Anaconda Package</a>
      
    
      
        <a class="sidebar-nav-item-list " href="http://abirger.github.io/conda-recipes/Testing-the-IOOS-environment/">Testing the IOOS Environment</a>
      
    
      
        <a class="sidebar-nav-item-list " href="http://abirger.github.io/conda-recipes/Customizing-the-notebook-settings/">Customizing the Notebook Settings</a>
      
    
      
        <a class="sidebar-nav-item-list  active " href="http://abirger.github.io/conda-recipes/Using-Obvious-CI-to-build-IOOS-binaries/">Using Obvious CI to Build IOOS Binaries</a>
      
    
</p>
<p style="text-align:right">
      
</p>

    <a class="sidebar-nav-item" href="https://github.com/abirger/conda-recipes">GitHub repository <br> (currently on 'master')</a>
    <a class="sidebar-nav-item" href="https://github.com/abirger/conda-recipes/archive/master.zip">Download repository</a>


	</nav>

  <div class="sidebar-item">
    <span>&copy; 2015 U.S. IOOS. Rights reserved</span>
  </div>
</div>


    
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h2 class="masthead-title">
		  <a href="http://abirger.github.io/conda-recipes/" title="Home"> IOOS Conda Recipes &middot; 
		  <small>Instructions on the IOOS Python Virtual Environment</small>
		  <img src="http://abirger.github.io/conda-recipes/images/ioos_blue2.png" alt="Smiley face" align="right" /></a>
		  </h2>
        </div>
      </div>

      <div class="container content">


<div class="post">
  <h1 class="post-title">Using Obvious CI to Build IOOS Binaries</h1>
    <div id="toc" class="well col-md-4 col-sm-6">
    <nav id="TableOfContents">
<ul>
<li><a href="#instructions:91505557b1edc877f932e36adce36dc6">Instructions</a></li>
</ul>
</nav>
    </div>
  

<p><a href="https://github.com/pelson/Obvious-CI">Obvious-CI</a> is a collection of tools that help with continuous integration like <a href="https://travis-ci.org/ioos/conda-recipes/builds">travis-ci</a> and <a href="https://ci.appveyor.com/project/comtbot/conda-recipes/history">AppVeyor</a>.</p>

<p>Using Obvious-CI, the single script <code>obvci_conda_build_dir.py</code> can build all binaries in the repository, ordered by their dependency.  Note that <code>obvci_conda_build_dir.py</code> reads the packages that are already on the channels and does not build if they are the same.</p>

<h1 id="instructions:91505557b1edc877f932e36adce36dc6">Instructions</h1>

<ul>
<li>Type <code>conda info</code> to see what channels you have.  Remove any channels from your conda config that are not from continuum.  For example, if you see a channel called <code>rsignell</code>, remove it like this:</li>
</ul>

<pre><code class="language-bash">conda config --remove channels rsignell -f
</code></pre>

<ul>
<li>Add the channel you are trying to install packages to.  This was the build process will have access to the requirements as they are built.  If building packages to upload to <code>ioos</code>, then do:</li>
</ul>

<pre><code class="language-bash">conda config --add channels ioos -f
</code></pre>

<ul>
<li>Remove everything from the cache, in order to force the build process to download packages from the locations specified in the conda-recipes:</li>
</ul>

<pre><code class="language-bash">conda clean --tarballs --index-cache --packages --source-cache -y
</code></pre>

<ul>
<li>Remove the source code from the build directory.  This will be system dependent, but for example:</li>
</ul>

<pre><code class="language-bash">rm /home/testbed/anaconda/conda-bld/linux-64/*
</code></pre>

<ul>
<li>Install obvious-ci</li>
</ul>

<pre><code class="language-bash">conda install -c ioos obvious-ci
</code></pre>

<ul>
<li>Download the conda-recipes</li>
</ul>

<pre><code class="language-bash">git clone https://github.com/ioos/conda-recipes.git
</code></pre>

<ul>
<li>If you are an IOOS anaconda admin, or you are building for your own personal repository, you may want to upload the packages as you build.  The <code>obvci_conda_build_dir.py</code> script will do that for you if you set a <code>BINSTAR_TOKEN</code>:</li>
</ul>

<pre><code class="language-bash">TOKEN=$(binstar auth -n NAME-OF-YOUR-TOKEN --max-age 22896000 -c --scopes api)
export BINSTAR_TOKEN=$TOKEN
</code></pre>

<ul>
<li>Build all the packages in conda-recipes (and upload to <code>ioos</code> channel if <code>BINSTAR_TOKEN</code> is set):<br /></li>
</ul>

<pre><code class="language-bash">obvci_conda_build_dir.py ./conda-recipes ioos --channel main
</code></pre>

</div>




      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>

